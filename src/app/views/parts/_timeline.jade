include _loading_init

span(ng-if='layoutType == "grid"')
  .timeline.timeline--grid(infinite-scroll='tweets.nextPage()', infinite-scroll-distance='2', infinite-scroll-disabled='tweets.busy', masonry='masonry', preserve-order)
    .masonry-brick.timeline__post.timeline__post--grid(ng-repeat='tweet in tweets.items')
      .timeline__post--header.timeline__post--header--grid
        .timeline__post--header--info.timeline__post--header--info--grid
          .timeline__post--header--link.timeline__post--header--link--grid
            span.timeline__post--header--user.timeline__post--header--user--grid(twitter-id-str="{{::tweet.user.id_str}}", show-tweet="show-tweet")
              {{::tweet.user.screen_name}}
            span.timeline__post--header--rt_icon.timeline__post--header--rt_icon--grid(ng-if="tweet.retweeted_status")
              i.fa.fa-retweet
            a.timeline__post--header--rt_source.timeline__post--header--rt_source--grid(twitter-id-str="{{::tweet.retweeted_status.user.id_str}}", show-tweet="show-tweet")
              {{::tweet.retweeted_status.user.screen_name}}
            followable(ng-if='!tweet.followStatus', list-id-str="{{listIdStr}}", tweet="{{tweet}}", follow-status="tweet.followStatus")
        .timeline__post--header--time
          a(href="https://{{::tweet.sourceUrl}}", target="_blank")
            {{::tweet.time}}
      .timeline__post--icon.timeline__post--icon--grid
        img.fade(ng-src="{{::tweet.user.profile_image_url_https}}", img-preload="img-preload", show-tweet="show-tweet", twitter-id-str="{{::tweet.user.id_str}}")
      .timeline__post--image.timeline__post--image--grid(ng-repeat='picUrl in tweet.picUrlList')
        img.fade(ng-if="!tweet.video_url", ng-src="{{::picUrl}}", img-preload="img-preload", zoom-image="zoom-image", data-img-src="{{::picUrl}}")
        video(ng-if="tweet.video_url", poster="{{::picUrl}}", autoplay, loop, controls, muted)
          source(ng-src="{{::tweet.video_url | trusted}}", type="video/mp4")
      .timeline__post__text__container(ng-if="!config.isShowOnlyImage")
        .timeline__post--text.timeline__post--text--grid(ng-if="!tweet.retweeted_status", ng-bind-html='tweet.text | newlines')
        .timeline__post--blockquote.timeline__post--blockquote--grid(ng-if="tweet.retweeted_status")
          p
            a(twitter-id-str="{{::tweet.retweeted_status.user.id_str}}", show-tweet="show-tweet")
              {{::tweet.retweeted_status.user.screen_name}}
          blockquote
            .timeline__post--text(ng-bind-html='tweet.text | newlines')
      .timeline__post--footer.timeline__post--footer--grid
        .timeline__post--footer--contents
          .timeline__post--footer--contents--controls
            i.fa.fa-retweet.icon-retweet(retweet-num="tweet.retweetNum", retweeted='tweet.retweeted', tweet-id-str='{{::tweet.tweetIdStr}}', retweetable='retweetable')  {{tweet.retweetNum}}
            i.fa.fa-heart.icon-heart(fav-num="tweet.favNum", favorited='tweet.favorited', tweet-id-str='{{::tweet.tweetIdStr}}', favoritable='favoritable')  {{tweet.favNum}}
            // aタグがないとtextとcontrolsの間の余白がなくなり、レイアウトが崩れる。
            a
              i.fa.fa-download(data-url="{{::tweet.picOrigUrlList}}", filename="{{::tweet.fileName}}", download-from-url='download-from-url')

  .loading-bar.loading-bar--grid
    include _loading_fin

span(ng-if='layoutType == "list"')
  .timeline.timeline--list(infinite-scroll='tweets.nextPage()', infinite-scroll-distance='2', infinite-scroll-disabled='tweets.busy')
    .timeline__post(ng-repeat='tweet in tweets.items')
      .timeline__post--header
        .timeline__post--header--info
          .timeline__post--header--link
            span.timeline__post--header--user(twitter-id-str="{{::tweet.user.id_str}}", show-tweet="show-tweet")
              {{::tweet.user.screen_name}}
            span.timeline__post--header--rt_icon(ng-if="tweet.retweeted_status")
              i.fa.fa-retweet
            a.timeline__post--header--rt_source(twitter-id-str="{{::tweet.retweeted_status.user.id_str}}", show-tweet="show-tweet")
              {{::tweet.retweeted_status.user.screen_name}}
            followable(ng-if='!tweet.followStatus', list-id-str="{{listIdStr}}", tweet="{{tweet}}", follow-status="tweet.followStatus")
        .timeline__post--header--time
          a(href="https://{{::tweet.sourceUrl}}", target="_blank")
            {{::tweet.time}}
      .timeline__post--icon
        img.fade(ng-src="{{::tweet.user.profile_image_url_https}}", img-preload="img-preload", show-tweet="show-tweet", twitter-id-str="{{::tweet.user.id_str}}")
      .timeline__post--image(ng-repeat='picUrl in tweet.picUrlList')
        img.fade(ng-if="!tweet.video_url", ng-src="{{::picUrl}}", img-preload="img-preload", zoom-image="zoom-image", data-img-src="{{::picUrl}}")
        video(ng-if="tweet.video_url", poster="{{::picUrl}}", autoplay, loop, controls, muted)
          source(ng-src="{{::tweet.video_url | trusted}}", type="video/mp4")
      .timeline__post__text__container(ng-if="!config.isShowOnlyImage")
        .timeline__post--text(ng-if="!tweet.retweeted_status", ng-bind-html='tweet.text | newlines')
        .timeline__post--blockquote(ng-if="tweet.retweeted_status")
          p
            a(twitter-id-str="{{::tweet.retweeted_status.user.id_str}}", show-tweet="show-tweet")
              {{::tweet.retweeted_status.user.screen_name}}
          blockquote
            .timeline__post--text(ng-bind-html='tweet.text | newlines')
      .timeline__post--footer
        .timeline__post--footer--contents
          .timeline__post--footer--contents--controls
            i.fa.fa-retweet.icon-retweet(retweet-num="tweet.retweetNum", retweeted='tweet.retweeted', tweet-id-str='{{::tweet.tweetIdStr}}', retweetable='retweetable')  {{tweet.retweetNum}}
            i.fa.fa-heart.icon-heart(fav-num="tweet.favNum", favorited='tweet.favorited', tweet-id-str='{{::tweet.tweetIdStr}}', favoritable='favoritable')  {{tweet.favNum}}
            a
              i.fa.fa-download(data-url="{{::tweet.extended_entities.media[0].media_url}}:orig", filename="{{::tweet.fileName}}", download-from-url='download-from-url')
    .loading-bar
      include _loading_fin