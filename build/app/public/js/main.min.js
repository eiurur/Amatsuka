angular.module("myApp",["ngRoute","ngAnimate","ngSanitize","infinite-scroll","myApp.controllers","myApp.filters","myApp.services","myApp.factories","myApp.directives"]).constant("utils",{devices:{0:"PC",1:"Smart Phone",2:"Tablet",3:"Fablet",4:"Smart Watch"}}).run(["$rootScope","utils",function($rootScope,utils){return $rootScope.utils=utils}]).config(["$routeProvider","$locationProvider",function($routeProvider,$locationProvider){return $routeProvider.when("/",{templateUrl:"partials/index",controller:"IndexCtrl"}).when("/member",{templateUrl:"partials/member",controller:"MemberCtrl"}).when("/list",{templateUrl:"partials/list",controller:"ListCtrl"}).when("/settings",{templateUrl:"partials/settings",controller:"SettingsCtrl"}).when("/logout",{redirectTo:"/"}).when("http://127.0.0.1:4040/auth/twitter/callback",{redirectTo:"/"}),$locationProvider.html5Mode(!0)}]);var i,methods,_fn;methods=["log","warn","error","info","debug","dir"],_fn=function(m){window[m]=console[m]?console[m].bind(console):log};for(i in methods)_fn(methods[i]);angular.module("myApp.controllers",[]).controller("CommonCtrl",["$location","$log","$rootScope","$scope",function($location,$log,$rootScope){return $rootScope.$on("$locationChangeStart",function(event,next){$log.info("location changin to: "+next)})}]),angular.module("myApp.directives",[]).directive("boxLoading",["$interval",function($interval){return{restrict:"E",link:function(scope,element,attrs){var allocations,animate,count,rotate,tag;return tag='<div class="box-loader">\n  <b></b>\n  <b></b>\n  <b></b>\n  <b></b>\n  <b></b>\n  <b></b>\n  <b></b>\n  <b></b>\n  <b></b>\n</div>',element.append(tag),count=0,allocations=[0,1,2,5,8,7,6,3],rotate=function(){var bs;return bs=element.find("b"),_.map(bs,function(elem){return elem.style.background=attrs.base}),bs[allocations[count]].style.background=attrs.highlight,count++,8===count?count=0:void 0},animate=$interval(rotate,150)}}}]).directive("slideable",function(){return{restrict:"C",compile:function(element){var contents,postLink;contents=element.html(),element.html("<div class='slideable_content'\n  style='margin:0 !important; padding:0 !important'>\n  "+contents+"\n</div>"),postLink=function(scope,element,attrs){return attrs.duration=attrs.duration?attrs.duration:"0.4s",attrs.easing=attrs.easing?attrs.easing:"ease-in-out",element.css({overflow:"hidden",height:"0px",transitionProperty:"height",transitionDuration:attrs.duration,transitionTimingFunction:attrs.easing})}}}}).directive("slideToggle",function(){return{restrict:"A",link:function(scope,element,attrs){var content,target;return target=void 0,content=void 0,attrs.expanded=!1,element.bind("click",function(){var y;return target||(target=document.querySelector(attrs.slideToggle)),content||(content=target.querySelector(".slideable_content")),attrs.expanded?target.style.height="0px":(content.style.border="1px solid rgba(0,0,0,0)",y=content.clientHeight,content.style.border=0,target.style.height=y+"px"),attrs.expanded=!attrs.expanded})}}}).directive("imgPreload",function(){return{restrict:"A",link:function(scope,element){return element.on("load",function(){return element.addClass("in")}).on("error",function(){})}}}).directive("scrollOnClick",function(){return{restrict:"A",scope:{scrollTo:"@"},link:function(scope,element){return element.on("click",function(){return $("html, body").animate({scrollTop:$(scope.scrollTo).offset().top},"slow")})}}}),angular.module("myApp.factories",[]).factory("Tweets",["$http","$q","TweetService",function($http,$q,TweetService){var Tweets;return Tweets=function(){function Tweets(items,maxId,type,user){this.busy=!1,this.isLast=!1,this.method=null,this.items=items,this.maxId=maxId,this.type=type,"user_timeline"===this.type&&(this.user=user)}return Tweets.prototype.nextPage=function(){return this.busy||this.isLast?void 0:(this.method="user_timeline"===this.type?TweetService.getUserTimeline({twitterIdStr:this.user.id_str,maxId:this.maxId,count:100}):TweetService.getListsStatuses({listIdStr:TweetService.amatsukaList.data.id_str,maxId:this.maxId,count:100}),this.busy=!0,this.method.then(function(_this){return function(data){var itemsImageOnly,itemsNomalized;return _.isEmpty(data.data)?(_this.isLast=!0,void(_this.busy=!1)):(_this.maxId=TweetService.decStrNum(_.last(data.data).id_str),itemsImageOnly=TweetService.filterIncludeImage(data.data),itemsNomalized=TweetService.nomalizeTweets(itemsImageOnly,TweetService.amatsukaList.member))}}(this)).then(function(_this){return function(itemsNomalized){return $q.all(itemsNomalized.map(function(item){return _this.addTweet(item)})).then(function(){return void(_this.busy=!1)})}}(this)))},Tweets.prototype.addTweet=function(tweet){return[this.items][0].push(tweet)},Tweets}()}]),angular.module("myApp.filters",[]).filter("interpolate",["version",function(version){return function(text){return String(text).replace(/\%VERSION\%/g,version)}}]).filter("noHTML",function(){return function(text){return null!=text?text.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&/,"&amp;"):void 0}}).filter("newlines",["$sce",function($sce){return function(text){return $sce.trustAsHtml(null!=text?text.replace(/\n/g,"<br />"):"")}}]),angular.module("myApp.services",[]).service("CommonService",function(){return{isLoaded:!1}}),angular.module("myApp.controllers").controller("AdminUserCtrl",["$scope","$rootScope","$log","AuthService",function($scope,$rootScope,$log,AuthService){return $scope.isLoaded=!1,$scope.isAuthenticated=AuthService.status.isAuthenticated,AuthService.status.isAuthenticated?void($scope.isLoaded=!0):AuthService.isAuthenticated().success(function(data){return _.isNull(data.data)?void($scope.isLoaded=!0):(AuthService.status.isAuthenticated=!0,$scope.isAuthenticated=AuthService.status.isAuthenticated,AuthService.user=data.data,$scope.user=data.data,$scope.isLoaded=!0)}).error(function(){return void 0})}]),angular.module("myApp.controllers").controller("IndexCtrl",["$scope","$rootScope","$log","AuthService","TweetService","Tweets",function($scope,$rootScope,$log,AuthService,TweetService,Tweets){var amatsukaFollowList,amatsukaList,init,ls,maxId,params;if(!_.isEmpty(AuthService.user))return $scope.isLoaded=!1,ls=localStorage,maxId=maxId||0,amatsukaList=JSON.parse(ls.getItem("amatsukaList"))||{},amatsukaFollowList=JSON.parse(ls.getItem("amatsukaFollowList"))||[],TweetService.amatsukaList={data:amatsukaList,member:amatsukaFollowList},$rootScope.amatsukaFollowList=amatsukaFollowList,_.isEmpty(TweetService.amatsukaList.data)||_.isEmpty(TweetService.amatsukaList.member)?(TweetService.getListsList().then(function(data){return amatsukaList=_.findWhere(data.data,{name:"Amatsuka"}),$scope.listIdStr=amatsukaList.id_str,ls.setItem("amatsukaList",JSON.stringify(amatsukaList)),TweetService.getListsMembers({listIdStr:amatsukaList.id_str})}).then(function(data){return amatsukaFollowList=data.data.users,ls.setItem("amatsukaFollowList",JSON.stringify(amatsukaFollowList)),TweetService.getListsStatuses({listIdStr:amatsukaList.id_str,maxId:maxId,count:50})}).then(function(data){var tweetsNomalized,tweetsOnlyImage;return maxId=TweetService.decStrNum(_.last(data.data).id_str),tweetsOnlyImage=TweetService.filterIncludeImage(data.data),tweetsNomalized=TweetService.nomalizeTweets(tweetsOnlyImage,amatsukaFollowList),void($scope.tweets=new Tweets(tweetsNomalized,maxId))})["catch"](function(error){return"Cannot read property 'id_str' of undefined"===error.message?init():void 0}),init=function(){return params={name:"Amatsuka",mode:"private"},TweetService.createLists(params).then(function(data){return amatsukaList=data.data,$scope.listIdStr=amatsukaList.id_str,ls.setItem("amatsukaList",JSON.stringify(amatsukaList)),params={listIdStr:amatsukaList.id_str,twitterIdStr:AuthService.user._json.id_str},TweetService.createListsMembers(params)}).then(function(){return TweetService.getListsMembers({listIdStr:amatsukaList.id_str})}).then(function(data){return amatsukaFollowList=data.data.users,ls.setItem("amatsukaFollowList",JSON.stringify(amatsukaFollowList)),params={listIdStr:amatsukaList.id_str,maxId:maxId,count:50},TweetService.getListsStatuses(params)}).then(function(data){var tweets,tweetsNomalized;return maxId=TweetService.decStrNum(_.last(data.data).id_str),tweets=TweetService.filterIncludeImage(data.data),tweetsNomalized=TweetService.nomalizeTweets(tweets,amatsukaFollowList),$scope.tweets=new Tweets(tweetsNomalized,maxId),$scope.isLoaded=!0})},$scope.$on("newTweet",function(event,args){var newTweetsOnlyImage,tweetsNomalized;return newTweetsOnlyImage=TweetService.filterIncludeImage(args),tweetsNomalized=TweetService.nomalizeTweets(newTweetsOnlyImage,amatsukaFollowList),$scope.tweets.items=_.uniq(_.union($scope.tweets.items,tweetsNomalized),"id_str")}),$scope.$on("addMember2Index",function(event,args){return TweetService.applyFollowStatusChange($scope.tweets.items,args)})):(params={listIdStr:amatsukaList.id_str,count:20},void TweetService.getListsStatuses(params).then(function(data){var tweetsNomalized,tweetsOnlyImage;return maxId=TweetService.decStrNum(_.last(data.data).id_str),tweetsOnlyImage=TweetService.filterIncludeImage(data.data),tweetsNomalized=TweetService.nomalizeTweets(tweetsOnlyImage,amatsukaFollowList),$scope.listIdStr=amatsukaList.id_str,$scope.tweets=new Tweets(tweetsNomalized,maxId),$scope.isLoaded=!0,TweetService.getListsList()}).then(function(data){return amatsukaList=_.findWhere(data.data,{name:"Amatsuka"}),$scope.listIdStr=amatsukaList.id_str,ls.setItem("amatsukaList",JSON.stringify(amatsukaList)),TweetService.getListsMembers({listIdStr:amatsukaList.id_str})}).then(function(data){return amatsukaFollowList=data.data.users,ls.setItem("amatsukaFollowList",JSON.stringify(amatsukaFollowList))}))}]),angular.module("myApp.controllers").controller("MemberCtrl",["$scope","$log","AuthService","TweetService","Tweets",function($scope,$log,AuthService,TweetService){var ls,maxId;if(!_.isEmpty(AuthService.user))return ls=localStorage,maxId=maxId||0,$scope.limitNum=10,$scope.listIdStr=JSON.parse(ls.getItem("amatsukaList"))||{},$scope.amatsukaMemberList=JSON.parse(ls.getItem("amatsukaFollowList"))||[],_.isEmpty(TweetService.amatsukaList.data)||_.isEmpty(TweetService.amatsukaList.member)?TweetService.getListsList().then(function(data){var amatsukaList;return amatsukaList=_.findWhere(data.data,{name:"Amatsuka"}),$scope.listIdStr=amatsukaList.id_str,TweetService.amatsukaList.data=amatsukaList,TweetService.getListsMembers({listIdStr:amatsukaList.id_str})}).then(function(data){var membersNormalized;return membersNormalized=TweetService.nomarlizeMembers(data.data.users),$scope.amatsukaMemberList=membersNormalized,TweetService.amatsukaList.member=data.data.users,$scope.limitNum=1e5}):($scope.listIdStr=TweetService.amatsukaList.data.id_str,$scope.amatsukaMemberList=TweetService.nomarlizeMembers(TweetService.amatsukaList.member),void($scope.limitNum=1e5))}]),angular.module("myApp.controllers").controller("UserCtrl",["$scope","$rootScope","$log","AuthService","TweetService","Tweets",function($scope,$rootScope,$log,AuthService,TweetService,Tweets){return _.isEmpty(AuthService.user)?void 0:($scope.isOpened=!1,$scope.$on("userData",function(event,args){return $scope.isOpened?($scope.user=TweetService.nomarlizeMember(args),$scope.listIdStr=TweetService.amatsukaList.data.id_str):void 0}),$scope.$on("tweetData",function(event,args){var maxId,tweetsNomalized,tweetsOnlyImage;if($scope.isOpened)return maxId=TweetService.decStrNum(_.last(args).id_str),tweetsOnlyImage=TweetService.filterIncludeImage(args),tweetsNomalized=TweetService.nomalizeTweets(tweetsOnlyImage),$scope.tweets=new Tweets(tweetsNomalized,maxId,"user_timeline",$scope.user)}),$scope.$on("isOpened",function(){return $scope.isOpened=!0,$scope.user={},$scope.tweets={}}),$scope.$on("isClosed",function(){return $scope.isOpened=!1}),$scope.$on("addMember",function(event,args){return _.isUndefined($scope.tweets)?void 0:_.map($scope.tweets.items,function(tweet){var id_str,isRT;return isRT=_.has(tweet,"retweeted_status"),id_str=TweetService.get(tweet,"user.id_str",isRT),id_str===args?tweet.followStatus=!0:void 0})}))}]),angular.module("myApp.directives").directive("appVersion",["version",function(version){return function(scope,elm){elm.text(version)}}]),angular.module("myApp.directives").directive("favoritable",["TweetService",function(TweetService){return{restrict:"A",scope:{favNum:"=",favorited:"=",tweetIdStr:"@"},link:function(scope,element){return scope.favorited&&element.addClass("favorited"),element.on("click",function(){return scope.favorited?(element.removeClass("favorited"),TweetService.destroyFav({tweetIdStr:scope.tweetIdStr}).then(function(){return scope.favNum-=1,scope.favorited=!scope.favorited})):(element.addClass("favorited"),TweetService.createFav({tweetIdStr:scope.tweetIdStr}).then(function(){return scope.favNum+=1,scope.favorited=!scope.favorited}))})}}}]).directive("retweetable",["TweetService",function(TweetService){return{restrict:"A",scope:{retweetNum:"=",retweeted:"=",tweetIdStr:"@"},link:function(scope,element){return scope.retweeted&&element.addClass("retweeted"),element.on("click",function(){return scope.retweeted?(element.removeClass("retweeted"),TweetService.destroyStatus({tweetIdStr:scope.tweetIdStr}).then(function(){return scope.retweetNum-=1,scope.retweeted=!scope.retweeted})):window.confirm("リツイートしてもよろしいですか？")?(element.addClass("retweeted"),TweetService.retweetStatus({tweetIdStr:scope.tweetIdStr}).then(function(){return scope.retweetNum+=1,scope.retweeted=!scope.retweeted})):void 0})}}}]).directive("followable",["$rootScope","TweetService",function($rootScope,TweetService){return{restrict:"E",replace:!0,scope:{listIdStr:"@",twitterIdStr:"@",followStatus:"="},template:'<span class="label label-default timeline__post--header--label">{{content}}</span>',link:function(scope,element){return scope.followStatus===!1&&(scope.content="+"),element.on("mouseover",function(){return scope.content="フォロー",scope.$apply()}),element.on("mouseout",function(){return scope.content="+",scope.$apply()}),element.on("click",function(){var opts;return opts={listIdStr:scope.listIdStr,twitterIdStr:scope.twitterIdStr},scope.followStatus===!1?(element.addClass("label-success"),element.fadeOut(200),TweetService.createListsMembers(opts).then(function(){return TweetService.addMember(scope.twitterIdStr),void $rootScope.$broadcast("addMember",scope.twitterIdStr)})):void 0})}}}]).directive("followable",["$rootScope","TweetService",function($rootScope,TweetService){return{restrict:"A",scope:{listIdStr:"@",twitterIdStr:"@",followStatus:"="},link:function(scope,element){return element[0].innerText=scope.followStatus?"フォロー解除":"フォロー",element.on("click",function(){var opts;return opts={listIdStr:scope.listIdStr,twitterIdStr:scope.twitterIdStr},scope.isProcessing=!0,scope.followStatus===!0&&(element[0].innerText="フォロー",TweetService.destroyListsMembers(opts).then(function(){return TweetService.removeMember(scope.twitterIdStr),scope.isProcessing=!1})),scope.followStatus===!1&&(element[0].innerText="フォロー解除",TweetService.createListsMembers(opts).then(function(){return TweetService.addMember(scope.twitterIdStr),$rootScope.$broadcast("addMember",scope.twitterIdStr),scope.isProcessing=!1})),scope.followStatus=!scope.followStatus})}}}]).directive("showTweet",["$rootScope","TweetService",function($rootScope,TweetService){return{restrict:"A",scope:{twitterIdStr:"@"},link:function(scope,element){var showTweet;return showTweet=function(){return TweetService.showUsers({twitterIdStr:scope.twitterIdStr}).then(function(data){return $rootScope.$broadcast("userData",data.data),TweetService.getUserTimeline({twitterIdStr:scope.twitterIdStr})}).then(function(data){return $rootScope.$broadcast("tweetData",data.data)})},element.on("click",function(){var body,domUserSidebar,isOpenedSidebar,layer;return $rootScope.$broadcast("isOpened",!0),domUserSidebar=angular.element(document).find(".user-sidebar"),(isOpenedSidebar=-1!==domUserSidebar[0].className.indexOf(".user-sidebar-in"))?void showTweet():(domUserSidebar.addClass("user-sidebar-in"),body=angular.element(document).find("body"),body.addClass("scrollbar-y-hidden"),layer=angular.element(document).find(".layer"),layer.addClass("fullscreen-overlay"),showTweet(),layer.on("click",function(){return body.removeClass("scrollbar-y-hidden"),layer.removeClass("fullscreen-overlay"),domUserSidebar.removeClass("user-sidebar-in"),$rootScope.$broadcast("isClosed",!0)}))})}}}]).directive("newTweetLoad",["$rootScope","TweetService",function($rootScope,TweetService){return{restrict:"E",scope:{listIdStr:"@"},template:'<a class="btn" ng-disabled="isProcessing">{{text}}</a>',link:function(scope,element){return scope.text="新着を読み込む",element.on("click",function(){var params;return scope.isProcessing=!0,params={listIdStr:scope.listIdStr,count:50},TweetService.getListsStatuses(params).then(function(data){return $rootScope.$broadcast("newTweet",data.data),scope.text="新着を読み込む",scope.isProcessing=!1})})}}}]),angular.module("myApp.services").service("AuthService",["$http",function($http){return{findUserById:function(twitterIdStr){return $http.post("/api/findUserById",twitterIdStr)},isAuthenticated:function(){return $http.get("/api/isAuthenticated")},status:{isAuthenticated:!1},user:{}}}]),angular.module("myApp.services").service("TweetService",["$http","$q",function($http,$q){return{amatsukaList:{data:[],member:{}},registerMember2LocalStorage:function(){var ls;return ls=localStorage,ls.setItem("amatsukaFollowList",JSON.stringify(this.amatsukaList.member))},addMember:function(twitterIdStr){return this.showUsers({twitterIdStr:twitterIdStr}).then(function(_this){return function(data){return _this.amatsukaList.member.push(data.data),_this.registerMember2LocalStorage()}}(this))},removeMember:function(twitterIdStr){return this.amatsukaList.member=_.reject(this.amatsukaList.member,{id_str:twitterIdStr}),this.registerMember2LocalStorage()},activateLink:function(t){return t.replace(/((ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&amp;%@!&#45;\/]))?)/g,'<a href="$1" target="_blank">$1</a>').replace(/(^|\s)(@|＠)(\w+)/g,'$1<a href="http://www.twitter.com/$3" target="_blank">@$3</a>').replace(/(?:^|[^ーー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-Z0-9&_\/>]+)[#＃]([ー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-Z0-9_]*[ー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-Z]+[ー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-Z0-9_]*)/g,' <a href="http://twitter.com/search?q=%23$1" target="_blank">#$1</a>')},iconBigger:function(url){return _.isUndefined(url)?this.replace("normal","bigger"):url.replace("normal","bigger")},isFollow:function(target,isRT){return null==isRT&&(isRT=!0),_.has(target,"user")?!!_.findWhere(this.amatsukaList.member,{id_str:this.get(target,"user.id_str",isRT)}):!!_.findWhere(this.amatsukaList.member,{id_str:target.id_str})},applyFollowStatusChange:function(tweets,twitterIdStr){return _.map(tweets,function(_this){return function(tweet){var id_str,isRT;return isRT=_.has(tweet,"retweeted_status"),id_str=_this.get(tweet,"user.id_str",isRT),id_str===twitterIdStr?tweet.followStatus=!0:void 0}}(this))},nomalizeTweets:function(tweets){return _.each(tweets,function(_this){return function(tweet){var isRT;return isRT=_.has(tweet,"retweeted_status"),tweet.isRT=isRT,tweet.followStatus=_this.isFollow(tweet,isRT),tweet.text=_this.activateLink(tweet.text),tweet.time=_this.fromNow(_this.get(tweet,"tweet.created_at",!1)),tweet.retweetNum=_this.get(tweet,"tweet.retweet_count",isRT),tweet.favNum=_this.get(tweet,"tweet.favorite_count",isRT),tweet.tweetIdStr=_this.get(tweet,"tweet.id_str",isRT),tweet.sourceUrl=_this.get(tweet,"display_url",isRT),tweet.picOrigUrl=_this.get(tweet,"media_url:orig",isRT),tweet.user.profile_image_url=_this.iconBigger(tweet.user.profile_image_url)}}(this))},nomarlizeMembers:function(members){return _.each(members,function(_this){return function(member){return member.followStatus=!0,member.description=_this.activateLink(member.description),member.profile_image_url=_this.iconBigger(member.profile_image_url)}}(this))},nomarlizeMember:function(member){return member.followStatus=this.isFollow(member),member.description=this.activateLink(member.description),member.profile_image_url=this.iconBigger(member.profile_image_url),member},get:function(tweet,key,isRT){var t,_ref,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8;switch(t=isRT?tweet.retweeted_status:tweet,key){case"description":return t.user.description;case"display_url":return null!=(_ref=t.entities)&&null!=(_ref1=_ref.media)?_ref1[0].display_url:void 0;case"entities":return t.entities;case"expanded_url":return null!=(_ref2=t.entities)&&null!=(_ref3=_ref2.media)?_ref3[0].expanded_url:void 0;case"followers_count":return t.user.followers_count;case"friends_count":return t.user.friends_count;case"hashtags":return null!=(_ref4=t.entities)?_ref4.hashtags:void 0;case"media_url":return null!=(_ref5=t.entities)&&null!=(_ref6=_ref5.media)?_ref6[0].media_url:void 0;case"media_url:orig":return(null!=(_ref7=t.entities)&&null!=(_ref8=_ref7.media)?_ref8[0].media_url:void 0)+":orig";case"name":return t.user.name;case"profile_banner_url":return t.user.profile_banner_url;case"profile_image_url":return t.user.profile_image_url;case"statuses_count":return t.user.statuses_count;case"screen_name":return t.user.screen_name;case"source":return t.source;case"text":return t.text;case"timestamp_ms":return t.timestamp_ms;case"tweet.created_at":return t.created_at;case"tweet.favorite_count":return t.favorite_count;case"tweet.retweet_count":return t.retweet_count;case"tweet.id_str":return t.id_str;case"tweet.lang":return t.lang;case"user.created_at":return t.user.created_at;case"user.id_str":return t.user.id_str;case"user.favorite_count":return t.favorite_count;case"user.retweet_count":return t.retweet_count;case"user.lang":return t.user.lang;case"user.url":return t.user.url;default:return null}},decStrNum:function(n){var i,result;for(n=n.toString(),result=n,i=n.length-1;i>-1;){if("0"!==n[i])return result=result.substring(0,i)+(parseInt(n[i],10)-1).toString()+result.substring(i+1);result=result.substring(0,i)+"9"+result.substring(i+1),i--}return result},fromNow:function(time){return moment(time).fromNow(!0)},filterIncludeImage:function(tweets){return _.reject(tweets,function(tweet){return!_.has(tweet,"extended_entities")||_.isEmpty(tweet.extended_entities.media)})},twitterTest:function(user){return new Promise(function(resolve){return $http.post("/api/twitterTest",{user:user}).success(function(data){return resolve(data)})})},twitterPostTest:function(user){return new Promise(function(resolve){return $http.post("/api/twitterPostTest",{user:user}).success(function(data){return resolve(data)})})},getListsList:function(){return $q(function(resolve){return $http.get("/api/lists/list").success(function(data){return resolve(data)})})},createLists:function(params){return $q(function(resolve){return $http.post("/api/lists/create",params).success(function(data){return resolve(data)})})},getListsMembers:function(params){return $q(function(resolve){return $http.get("/api/lists/members/"+params.listIdStr+"/"+params.count).success(function(data){return resolve(data)})})},getListsStatuses:function(params){return $q(function(resolve){return $http.get("/api/lists/statuses/"+params.listIdStr+"/"+params.maxId+"/"+params.count).success(function(data){return resolve(data)})})},createListsMembers:function(params){return $q(function(resolve){return $http.post("/api/lists/members/create",params).success(function(data){return resolve(data)})})},destroyListsMembers:function(params){return $q(function(resolve){return $http.post("/api/lists/members/destroy",params).success(function(data){return resolve(data)})})},getUserTimeline:function(params){return $q(function(resolve){return $http.get("/api/timeline/"+params.twitterIdStr+"/"+params.maxId+"/"+params.count).success(function(data){return resolve(data)})})},showUsers:function(params){return $q(function(resolve){return $http.get("/api/users/show/"+params.twitterIdStr).success(function(data){return resolve(data)})})},createFav:function(params){return $q(function(resolve){return $http.post("/api/favorites/create",params).success(function(data){return resolve(data)})})},destroyFav:function(params){return $q(function(resolve){return $http.post("/api/favorites/destroy",params).success(function(data){return resolve(data)})})},retweetStatus:function(params){return $q(function(resolve){return $http.post("/api/statuses/retweet",params).success(function(data){return resolve(data)})})},destroyStatus:function(params){return $q(function(resolve){return $http.post("/api/statuses/destroy",params).success(function(data){return resolve(data)})})}}}]);